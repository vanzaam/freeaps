---
description: Security and networking
globs: ["**/*.swift"]
alwaysApply: true
---

# Security and Networking

## Network Operations
- Use URLSession.shared.dataTaskPublisher with Combine for async operations
- Implement proper timeout handling for network requests
- Use HTTPS for all network communications
- Validate SSL certificates and handle certificate errors appropriately

## Data Security
- Secure storage of sensitive data in Keychain
- SHA1 hashing for API secrets before transmission
- Never store passwords or tokens in plain text
- Use proper encryption for sensitive data at rest

## Input Validation
- Validate all user inputs before processing
- Sanitize data before sending to external services
- Implement proper bounds checking for numeric inputs
- Use appropriate data types for different input types

## Error Handling
- Implement robust error handling for network and Keychain operations
- Provide meaningful error messages to users
- Log security-related errors for monitoring
- Handle network failures gracefully

## Authentication
- Use secure authentication methods
- Implement proper session management
- Handle authentication failures appropriately
- Use secure token storage and transmission

## Best Practices
- Follow OWASP security guidelines
- Implement proper access controls
- Use secure coding practices
- Regular security audits and updates
- Monitor for security vulnerabilities
- Implement proper logging for security events